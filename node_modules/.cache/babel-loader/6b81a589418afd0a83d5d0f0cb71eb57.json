{"ast":null,"code":"var _jsxFileName = \"/Users/davo/Desktop/admin/src/pages/reports/performanceReport.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Box, CircularProgress } from '@mui/material';\nimport moment from 'moment';\nimport WrapperCertificates from '../../layouts/certificates/wrapperCertificates';\nimport EnhancedTable from '../../layouts/table/table';\nimport UsersApi from '../../api/users';\nimport ReportsApi from '../../api/reports';\nimport { UseCertificateContext } from '../../context/certificateContext/certificateContext';\nimport PaginationContainer from '../../layouts/pagination/pagination';\nimport SelectWithSearch from '../../layouts/select/selectWithSearch';\nimport AssignDates from '../../layouts/assignDates/assignDates';\nimport ButtonBlue from '../../layouts/buttons/buttonBlue';\nimport ButtonTranparentBorder from '../../layouts/buttons/buttonTransparentBorder';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst PerformanceReport = () => {\n  _s();\n\n  const {\n    setShowCertificate,\n    showCertificate,\n    setEvaluateeName,\n    evaluateeName,\n    setTotalScore,\n    setCreateDate,\n    totalScore,\n    setMenual,\n    menual,\n    createDate,\n    evaluateeId,\n    setNoScore,\n    // noScore,\n    certificateType\n  } = UseCertificateContext();\n  const [eventTitleId, setEventTitleId] = useState(-1);\n  const [eventTitleData, setEventTitleData] = useState([]);\n  const [rowsOfTable, setRowsOfTable] = useState([]);\n  const [searchEvaluateeId, setSearchEvaluateeId] = useState(-1);\n  const [nameOfUsers, setNameOfUsers] = useState([]);\n  const [page, setPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n  const [countPagination, setCountPagination] = useState(0);\n  const [totalCountOfPagination, setTotalCountOfPagination] = useState();\n  const [isLoadingApply, setIsLoadingApply] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [evaluationType, setEvaluationType] = useState(-1);\n  const [evaluationTypeValues] = useState([{\n    id: 1,\n    name: 'With score'\n  }, {\n    id: 2,\n    name: 'Without score'\n  }]);\n  useEffect(() => {\n    ;\n\n    (async () => {\n      setIsLoading(true);\n      const response = await ReportsApi.evaluationAbsolutePointReportList({\n        page,\n        pageSize,\n        eventId: eventTitleId,\n        evaluateeId: searchEvaluateeId,\n        evaluationType: evaluationType === 2 ? 0 : evaluationType,\n        ...(startDate && {\n          startDate: moment(startDate).format()\n        }),\n        ...(endDate && {\n          endDate: moment(endDate).format()\n        })\n      });\n      setTotalCountOfPagination(response.data.totalCount);\n      const updateEventsTitleData = [...response.data.reportItems.map(item => ({\n        name: item.eventTitle,\n        id: item.eventId\n      }))];\n      setEventTitleData(updateEventsTitleData.filter(element => {\n        const isDuplicate = updateEventsTitleData.includes(element.id);\n\n        if (!isDuplicate) {\n          updateEventsTitleData.push(element.id);\n          return true;\n        }\n\n        return false;\n      }));\n      setRowsOfTable(response.data.reportItems);\n      setIsLoading(false);\n    })();\n  }, [pageSize, page]);\n  useEffect(() => {\n    if (totalCountOfPagination) {\n      if (pageSize >= totalCountOfPagination) {\n        setCountPagination(1);\n      } else {\n        setCountPagination(Math.ceil(totalCountOfPagination / pageSize));\n      }\n    }\n  }, [pageSize, page, totalCountOfPagination]);\n  useEffect(() => {\n    ;\n\n    (async () => {\n      const resultUsers = await UsersApi.usersList();\n      setNameOfUsers([...resultUsers.data.map(item => ({\n        name: item.firstName,\n        id: item.id\n      }))]);\n    })();\n  }, []);\n\n  const handleChangeDate = (start, end) => {\n    setStartDate(start);\n    setEndDate(end);\n  };\n\n  const handleShowCertificate = () => {\n    setShowCertificate(true);\n    setMenual(true);\n    setEvaluateeName('');\n    setTotalScore('');\n    setCreateDate('');\n  };\n\n  const handleApply = async () => {\n    setIsLoadingApply(true);\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: 10,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      ...(eventTitleId && {\n        eventId: eventTitleId\n      }),\n      ...(startDate && {\n        startDate: moment(startDate).format()\n      }),\n      ...(endDate && {\n        endDate: moment(endDate).format()\n      }),\n      ...(searchEvaluateeId && {\n        evaluateeId: searchEvaluateeId\n      })\n    });\n    setPage(1);\n    setPageSize(10);\n    setRowsOfTable(response.data.reportItems);\n    setTotalCountOfPagination(response.data.totalCount);\n\n    if (evaluationType === 1) {\n      setNoScore(false);\n    } else {\n      setNoScore(true);\n    }\n\n    setIsLoadingApply(false);\n  };\n\n  const handleOpenCertificates = () => {\n    if (!showCertificate) {\n      setShowCertificate(true);\n    } else {\n      setShowCertificate(false);\n      setEvaluateeName('');\n      setTotalScore('');\n      setCreateDate('');\n    }\n  };\n\n  const handleCreateCertificate = async () => {\n    if (menual) {\n      await ReportsApi.createManualCertificate({\n        userName: evaluateeName,\n        totalScore,\n        createDate,\n        certificateType\n      }).then(response => {\n        const url = window.URL.createObjectURL(new Blob([response.data], {\n          type: 'application/pdf'\n        }));\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', 'Certificate.pdf');\n        document.body.appendChild(link);\n        link.click();\n      });\n    } else {\n      await ReportsApi.createCertificate({\n        userId: evaluateeId,\n        totalScore,\n        certificateType\n      }).then(response => {\n        const url = window.URL.createObjectURL(new Blob([response.data], {\n          type: 'application/pdf'\n        }));\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', 'Certificate.pdf');\n        document.body.appendChild(link);\n        link.click();\n      });\n    }\n  };\n\n  const handleClear = async () => {\n    setIsLoading(true);\n    setEventTitleId(-1);\n    setSearchEvaluateeId(-1);\n    setStartDate('');\n    setEndDate('');\n    setNoScore(false);\n    setEvaluationType(-1);\n    setPage(1);\n    setPageSize(10);\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: 10,\n      evaluationType: -1,\n      eventId: -1,\n      evaluateeId: -1\n    });\n    setRowsOfTable(response.data.reportItems);\n    setTotalCountOfPagination(response.data.totalCount);\n    setIsLoading(false);\n  };\n\n  const handleCreateReportTablePDF = async () => {\n    await ReportsApi.createReportEvaluationAbsolute({\n      page: 1,\n      pageSize: -1,\n      adminId: -1,\n      evaluatorId: -1,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      eventId: eventTitleId,\n      evaluateeId: searchEvaluateeId\n    }).then(response => {\n      const url = window.URL.createObjectURL(new Blob([response.data], {\n        type: 'application/pdf'\n      }));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', 'PairsReportPdf.pdf');\n      document.body.appendChild(link);\n      link.click();\n    });\n  }; // const filterRating = (number: number) => {\n  //   if (number <= 3) {\n  //     return rowsOfTable\n  //       .filter((item) => item.sumPoint / item.questionCount <= number)\n  //       .length.toString()\n  //   }\n  //   return rowsOfTable\n  //     .filter((item) => item.sumPoint / item.questionCount >= number)\n  //     .length.toString()\n  // }\n\n\n  const handleCreateReportTableCVS = async () => {\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: totalCountOfPagination,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      ...(eventTitleId && {\n        eventId: eventTitleId\n      }),\n      ...(startDate && {\n        startDate: moment(startDate).format()\n      }),\n      ...(endDate && {\n        endDate: moment(endDate).format()\n      }),\n      ...(searchEvaluateeId && {\n        evaluateeId: searchEvaluateeId\n      })\n    });\n\n    if (response.data.reportItems) {\n      const data = [['Event', 'Evaluatee name', 'Hire Date', 'Job Title', 'Salary', 'Rating', 'Bonus: %', 'Bonus Amount']];\n      let totalBonuses = 0;\n      let totalSalariesAMD = 0;\n      let totalSalariesUSD = 0;\n      response.data.reportItems.forEach(item => {\n        totalBonuses += item.monthlySalary * item.bonusPercentage / 100; // totalSalariesAMD +=\n        //   item.currency === 1 ? (item.monthlySalary * item.bonusPercentage) / 100 : 0\n        // totalSalariesUSD +=\n        //   item.currency !== 1 ? (item.monthlySalary * item.bonusPercentage) / 100 : 0\n\n        totalSalariesAMD += item.currency === 1 ? item.monthlySalary : 0;\n        totalSalariesUSD += item.currency !== 1 ? item.monthlySalary : 0;\n        data.push([item.eventTitle, item.evaluateeName, item.hireDate, item.evaluateePosition, `${item.monthlySalary} ${item.currency === 1 ? 'AMD' : 'USD'}`, item.averagePoint.toString(), item.bonusPercentage.toString(), `${(item.monthlySalary * item.bonusPercentage / 100).toString()} ${item.currency === 1 ? 'AMD' : 'USD'}`]);\n      });\n      data.push([' ']);\n      data.push(['Total Salaries', `${totalSalariesAMD.toString()} AMD`, `${totalSalariesUSD.toString()} USD`]);\n      data.push(['Total Bonuses', totalBonuses.toString()]); // data.push([' '])\n      // data.push([filterRating(4), 'Exceptional'])\n      // data.push([filterRating(3), 'Very Good'])\n      // data.push([filterRating(2), 'Good'])\n      // data.push([filterRating(1), 'Normal'])\n\n      const csvContent = `data:text/csv;charset=utf-8,${data.map(e => e.join(',')).join('\\n')}`;\n      const encodedUri = encodeURI(csvContent);\n      const link = document.createElement('a');\n      link.setAttribute('href', encodedUri);\n      link.setAttribute('download', 'my_data.csv');\n      document.body.appendChild(link);\n      link.click();\n    }\n  };\n\n  if (!showCertificate) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      className: \"performance-report\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        className: \"d-flex flex-wrap mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          className: \"width-px-320 mt-18 mr-16\",\n          children: /*#__PURE__*/_jsxDEV(AssignDates, {\n            applyHandle: handleChangeDate,\n            startDateProps: startDate,\n            endDateProps: endDate,\n            disabled: false,\n            border: false,\n            fromToday: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-18 mr-16 width-px-218\",\n          children: /*#__PURE__*/_jsxDEV(SelectWithSearch, {\n            data: eventTitleData,\n            id: eventTitleId,\n            isLoading: isLoading,\n            setId: setEventTitleId,\n            label: \"Event Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-18 mr-16 width-px-218\",\n          children: /*#__PURE__*/_jsxDEV(SelectWithSearch, {\n            data: nameOfUsers,\n            id: searchEvaluateeId,\n            isLoading: isLoading,\n            setId: setSearchEvaluateeId,\n            label: \"Evaluatee\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-18 mr-48 width-px-218\",\n          children: /*#__PURE__*/_jsxDEV(SelectWithSearch, {\n            data: evaluationTypeValues,\n            id: evaluationType,\n            isLoading: isLoading,\n            setId: setEvaluationType,\n            label: \"Evaluation Type\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-18 mr-16\",\n          children: /*#__PURE__*/_jsxDEV(ButtonTranparentBorder, {\n            handleClick: handleClear,\n            title: \"Clear\",\n            width: \"width150\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-18 mr-16 \",\n          children: !isLoadingApply ? /*#__PURE__*/_jsxDEV(ButtonBlue, {\n            handleClick: handleApply,\n            title: \"Apply\",\n            width: \"width150\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        className: \"mt-94\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-26 d-flex justify-end export-button-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            children: /*#__PURE__*/_jsxDEV(ButtonTranparentBorder, {\n              handleClick: handleCreateReportTablePDF,\n              title: \"EXPORT AS PDF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            className: \"ml-10\",\n            children: /*#__PURE__*/_jsxDEV(ButtonTranparentBorder, {\n              handleClick: handleCreateReportTableCVS,\n              title: \"EXPORT AS CSV\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            className: \"ml-10\",\n            children: /*#__PURE__*/_jsxDEV(ButtonBlue, {\n              handleClick: handleShowCertificate,\n              title: \"GET CERTIFICATE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          className: \"mt-40\",\n          children: !isLoading && rowsOfTable.length ? /*#__PURE__*/_jsxDEV(Box, {\n            children: [/*#__PURE__*/_jsxDEV(EnhancedTable, {\n              table: \"performance-report\",\n              rows: rowsOfTable\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(PaginationContainer, {\n              limitData: totalCountOfPagination,\n              setPage: setPage,\n              page: page,\n              countPagination: countPagination,\n              pageSize: pageSize,\n              setPageSize: setPageSize\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-center\",\n            children: isLoading ? /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 30\n            }, this) : 'There is not data'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"saved-submissions-certification\",\n    children: /*#__PURE__*/_jsxDEV(WrapperCertificates, {\n      handleCreateCertificate: handleCreateCertificate,\n      handleOpenCertificates: handleOpenCertificates\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 421,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PerformanceReport, \"xBM+Yhy9A5kixkAqep6bObRbSYw=\");\n\n_c = PerformanceReport;\nexport default PerformanceReport;\n\nvar _c;\n\n$RefreshReg$(_c, \"PerformanceReport\");","map":{"version":3,"sources":["/Users/davo/Desktop/admin/src/pages/reports/performanceReport.tsx"],"names":["React","useEffect","useState","Box","CircularProgress","moment","WrapperCertificates","EnhancedTable","UsersApi","ReportsApi","UseCertificateContext","PaginationContainer","SelectWithSearch","AssignDates","ButtonBlue","ButtonTranparentBorder","PerformanceReport","setShowCertificate","showCertificate","setEvaluateeName","evaluateeName","setTotalScore","setCreateDate","totalScore","setMenual","menual","createDate","evaluateeId","setNoScore","certificateType","eventTitleId","setEventTitleId","eventTitleData","setEventTitleData","rowsOfTable","setRowsOfTable","searchEvaluateeId","setSearchEvaluateeId","nameOfUsers","setNameOfUsers","page","setPage","pageSize","setPageSize","countPagination","setCountPagination","totalCountOfPagination","setTotalCountOfPagination","isLoadingApply","setIsLoadingApply","isLoading","setIsLoading","startDate","setStartDate","endDate","setEndDate","evaluationType","setEvaluationType","evaluationTypeValues","id","name","response","evaluationAbsolutePointReportList","eventId","format","data","totalCount","updateEventsTitleData","reportItems","map","item","eventTitle","filter","element","isDuplicate","includes","push","Math","ceil","resultUsers","usersList","firstName","handleChangeDate","start","end","handleShowCertificate","handleApply","handleOpenCertificates","handleCreateCertificate","createManualCertificate","userName","then","url","window","URL","createObjectURL","Blob","type","link","document","createElement","href","setAttribute","body","appendChild","click","createCertificate","userId","handleClear","handleCreateReportTablePDF","createReportEvaluationAbsolute","adminId","evaluatorId","handleCreateReportTableCVS","totalBonuses","totalSalariesAMD","totalSalariesUSD","forEach","monthlySalary","bonusPercentage","currency","hireDate","evaluateePosition","averagePoint","toString","csvContent","e","join","encodedUri","encodeURI","length"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,SAAQC,GAAR,EAAaC,gBAAb,QAAoC,eAApC;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,OAAOC,mBAAP,MAAgC,gDAAhC;AACA,OAAOC,aAAP,MAA0B,2BAA1B;AACA,OAAOC,QAAP,MAAqB,iBAArB;AAEA,OAAOC,UAAP,MAAuB,mBAAvB;AACA,SAAQC,qBAAR,QAAoC,qDAApC;AAEA,OAAOC,mBAAP,MAAgC,qCAAhC;AACA,OAAOC,gBAAP,MAA6B,uCAA7B;AACA,OAAOC,WAAP,MAAwB,uCAAxB;AACA,OAAOC,UAAP,MAAuB,kCAAvB;AACA,OAAOC,sBAAP,MAAmC,+CAAnC;;;AAEA,MAAMC,iBAAiB,GAAG,MAAM;AAAA;;AAC9B,QAAM;AACJC,IAAAA,kBADI;AAEJC,IAAAA,eAFI;AAGJC,IAAAA,gBAHI;AAIJC,IAAAA,aAJI;AAKJC,IAAAA,aALI;AAMJC,IAAAA,aANI;AAOJC,IAAAA,UAPI;AAQJC,IAAAA,SARI;AASJC,IAAAA,MATI;AAUJC,IAAAA,UAVI;AAWJC,IAAAA,WAXI;AAYJC,IAAAA,UAZI;AAaJ;AACAC,IAAAA;AAdI,MAeFnB,qBAAqB,EAfzB;AAiBA,QAAM,CAACoB,YAAD,EAAeC,eAAf,IAAkC7B,QAAQ,CAAS,CAAC,CAAV,CAAhD;AACA,QAAM,CAAC8B,cAAD,EAAiBC,iBAAjB,IAAsC/B,QAAQ,CAA+B,EAA/B,CAApD;AACA,QAAM,CAACgC,WAAD,EAAcC,cAAd,IAAgCjC,QAAQ,CAAwC,EAAxC,CAA9C;AACA,QAAM,CAACkC,iBAAD,EAAoBC,oBAApB,IAA4CnC,QAAQ,CAAS,CAAC,CAAV,CAA1D;AACA,QAAM,CAACoC,WAAD,EAAcC,cAAd,IAAgCrC,QAAQ,CAA+B,EAA/B,CAA9C;AACA,QAAM,CAACsC,IAAD,EAAOC,OAAP,IAAkBvC,QAAQ,CAAS,CAAT,CAAhC;AACA,QAAM,CAACwC,QAAD,EAAWC,WAAX,IAA0BzC,QAAQ,CAAS,EAAT,CAAxC;AACA,QAAM,CAAC0C,eAAD,EAAkBC,kBAAlB,IAAwC3C,QAAQ,CAAS,CAAT,CAAtD;AACA,QAAM,CAAC4C,sBAAD,EAAyBC,yBAAzB,IAAsD7C,QAAQ,EAApE;AACA,QAAM,CAAC8C,cAAD,EAAiBC,iBAAjB,IAAsC/C,QAAQ,CAAU,KAAV,CAApD;AACA,QAAM,CAACgD,SAAD,EAAYC,YAAZ,IAA4BjD,QAAQ,CAAU,KAAV,CAA1C;AACA,QAAM,CAACkD,SAAD,EAAYC,YAAZ,IAA4BnD,QAAQ,CAAS,EAAT,CAA1C;AACA,QAAM,CAACoD,OAAD,EAAUC,UAAV,IAAwBrD,QAAQ,CAAS,EAAT,CAAtC;AACA,QAAM,CAACsD,cAAD,EAAiBC,iBAAjB,IAAsCvD,QAAQ,CAAS,CAAC,CAAV,CAApD;AACA,QAAM,CAACwD,oBAAD,IAAyBxD,QAAQ,CAA+B,CACpE;AACEyD,IAAAA,EAAE,EAAE,CADN;AAEEC,IAAAA,IAAI,EAAE;AAFR,GADoE,EAKpE;AACED,IAAAA,EAAE,EAAE,CADN;AAEEC,IAAAA,IAAI,EAAE;AAFR,GALoE,CAA/B,CAAvC;AAWA3D,EAAAA,SAAS,CAAC,MAAM;AACd;;AAAC,KAAC,YAAY;AACZkD,MAAAA,YAAY,CAAC,IAAD,CAAZ;AAEA,YAAMU,QAAQ,GAAG,MAAMpD,UAAU,CAACqD,iCAAX,CAA6C;AAClEtB,QAAAA,IADkE;AAElEE,QAAAA,QAFkE;AAGlEqB,QAAAA,OAAO,EAAEjC,YAHyD;AAIlEH,QAAAA,WAAW,EAAES,iBAJqD;AAKlEoB,QAAAA,cAAc,EAAEA,cAAc,KAAK,CAAnB,GAAuB,CAAvB,GAA2BA,cALuB;AAMlE,YAAIJ,SAAS,IAAI;AAACA,UAAAA,SAAS,EAAE/C,MAAM,CAAC+C,SAAD,CAAN,CAAkBY,MAAlB;AAAZ,SAAjB,CANkE;AAOlE,YAAIV,OAAO,IAAI;AAACA,UAAAA,OAAO,EAAEjD,MAAM,CAACiD,OAAD,CAAN,CAAgBU,MAAhB;AAAV,SAAf;AAPkE,OAA7C,CAAvB;AASAjB,MAAAA,yBAAyB,CAACc,QAAQ,CAACI,IAAT,CAAcC,UAAf,CAAzB;AAEA,YAAMC,qBAAqB,GAAG,CAC5B,GAAGN,QAAQ,CAACI,IAAT,CAAcG,WAAd,CAA0BC,GAA1B,CAA+BC,IAAD,KAAkD;AACjFV,QAAAA,IAAI,EAAEU,IAAI,CAACC,UADsE;AAEjFZ,QAAAA,EAAE,EAAEW,IAAI,CAACP;AAFwE,OAAlD,CAA9B,CADyB,CAA9B;AAOA9B,MAAAA,iBAAiB,CACfkC,qBAAqB,CAACK,MAAtB,CAA8BC,OAAD,IAA2B;AACtD,cAAMC,WAAW,GAAGP,qBAAqB,CAACQ,QAAtB,CAA+BF,OAAO,CAACd,EAAvC,CAApB;;AACA,YAAI,CAACe,WAAL,EAAkB;AAChBP,UAAAA,qBAAqB,CAACS,IAAtB,CAA2BH,OAAO,CAACd,EAAnC;AACA,iBAAO,IAAP;AACD;;AACD,eAAO,KAAP;AACD,OAPD,CADe,CAAjB;AAWAxB,MAAAA,cAAc,CAAC0B,QAAQ,CAACI,IAAT,CAAcG,WAAf,CAAd;AACAjB,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,KAlCA;AAmCF,GApCQ,EAoCN,CAACT,QAAD,EAAWF,IAAX,CApCM,CAAT;AAsCAvC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI6C,sBAAJ,EAA4B;AAC1B,UAAIJ,QAAQ,IAAII,sBAAhB,EAAwC;AACtCD,QAAAA,kBAAkB,CAAC,CAAD,CAAlB;AACD,OAFD,MAEO;AACLA,QAAAA,kBAAkB,CAACgC,IAAI,CAACC,IAAL,CAAUhC,sBAAsB,GAAGJ,QAAnC,CAAD,CAAlB;AACD;AACF;AACF,GARQ,EAQN,CAACA,QAAD,EAAWF,IAAX,EAAiBM,sBAAjB,CARM,CAAT;AAUA7C,EAAAA,SAAS,CAAC,MAAM;AACd;;AAAC,KAAC,YAAY;AACZ,YAAM8E,WAAW,GAAG,MAAMvE,QAAQ,CAACwE,SAAT,EAA1B;AACAzC,MAAAA,cAAc,CAAC,CACb,GAAGwC,WAAW,CAACd,IAAZ,CAAiBI,GAAjB,CAAsBC,IAAD,KAA4C;AAClEV,QAAAA,IAAI,EAAEU,IAAI,CAACW,SADuD;AAElEtB,QAAAA,EAAE,EAAEW,IAAI,CAACX;AAFyD,OAA5C,CAArB,CADU,CAAD,CAAd;AAMD,KARA;AASF,GAVQ,EAUN,EAVM,CAAT;;AAYA,QAAMuB,gBAAgB,GAAG,CAACC,KAAD,EAAgBC,GAAhB,KAAgC;AACvD/B,IAAAA,YAAY,CAAC8B,KAAD,CAAZ;AACA5B,IAAAA,UAAU,CAAC6B,GAAD,CAAV;AACD,GAHD;;AAKA,QAAMC,qBAAqB,GAAG,MAAM;AAClCpE,IAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAO,IAAAA,SAAS,CAAC,IAAD,CAAT;AACAL,IAAAA,gBAAgB,CAAC,EAAD,CAAhB;AACAE,IAAAA,aAAa,CAAC,EAAD,CAAb;AACAC,IAAAA,aAAa,CAAC,EAAD,CAAb;AACD,GAND;;AAQA,QAAMgE,WAAW,GAAG,YAAY;AAC9BrC,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AAEA,UAAMY,QAAQ,GAAG,MAAMpD,UAAU,CAACqD,iCAAX,CAA6C;AAClEtB,MAAAA,IAAI,EAAE,CAD4D;AAElEE,MAAAA,QAAQ,EAAE,EAFwD;AAGlEc,MAAAA,cAAc,EAAEA,cAAc,KAAK,CAAnB,GAAuB,CAAvB,GAA2BA,cAHuB;AAIlE,UAAI1B,YAAY,IAAI;AAACiC,QAAAA,OAAO,EAAEjC;AAAV,OAApB,CAJkE;AAKlE,UAAIsB,SAAS,IAAI;AAACA,QAAAA,SAAS,EAAE/C,MAAM,CAAC+C,SAAD,CAAN,CAAkBY,MAAlB;AAAZ,OAAjB,CALkE;AAMlE,UAAIV,OAAO,IAAI;AAACA,QAAAA,OAAO,EAAEjD,MAAM,CAACiD,OAAD,CAAN,CAAgBU,MAAhB;AAAV,OAAf,CANkE;AAOlE,UAAI5B,iBAAiB,IAAI;AAACT,QAAAA,WAAW,EAAES;AAAd,OAAzB;AAPkE,KAA7C,CAAvB;AAUAK,IAAAA,OAAO,CAAC,CAAD,CAAP;AACAE,IAAAA,WAAW,CAAC,EAAD,CAAX;AACAR,IAAAA,cAAc,CAAC0B,QAAQ,CAACI,IAAT,CAAcG,WAAf,CAAd;AACArB,IAAAA,yBAAyB,CAACc,QAAQ,CAACI,IAAT,CAAcC,UAAf,CAAzB;;AACA,QAAIV,cAAc,KAAK,CAAvB,EAA0B;AACxB5B,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAFD,MAEO;AACLA,MAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AACDqB,IAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACD,GAvBD;;AAyBA,QAAMsC,sBAAsB,GAAG,MAAM;AACnC,QAAI,CAACrE,eAAL,EAAsB;AACpBD,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACD,KAFD,MAEO;AACLA,MAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAE,MAAAA,gBAAgB,CAAC,EAAD,CAAhB;AACAE,MAAAA,aAAa,CAAC,EAAD,CAAb;AACAC,MAAAA,aAAa,CAAC,EAAD,CAAb;AACD;AACF,GATD;;AAWA,QAAMkE,uBAAuB,GAAG,YAAY;AAC1C,QAAI/D,MAAJ,EAAY;AACV,YAAMhB,UAAU,CAACgF,uBAAX,CAAmC;AACvCC,QAAAA,QAAQ,EAAEtE,aAD6B;AAEvCG,QAAAA,UAFuC;AAGvCG,QAAAA,UAHuC;AAIvCG,QAAAA;AAJuC,OAAnC,EAKH8D,IALG,CAKG9B,QAAD,IAA6B;AACnC,cAAM+B,GAAG,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2B,IAAIC,IAAJ,CAAS,CAACnC,QAAQ,CAACI,IAAV,CAAT,EAA0B;AAACgC,UAAAA,IAAI,EAAE;AAAP,SAA1B,CAA3B,CAAZ;AACA,cAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,QAAAA,IAAI,CAACG,IAAL,GAAYT,GAAZ;AACAM,QAAAA,IAAI,CAACI,YAAL,CAAkB,UAAlB,EAA8B,iBAA9B;AACAH,QAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,IAA1B;AACAA,QAAAA,IAAI,CAACO,KAAL;AACD,OAZK,CAAN;AAaD,KAdD,MAcO;AACL,YAAMhG,UAAU,CAACiG,iBAAX,CAA6B;AAACC,QAAAA,MAAM,EAAEhF,WAAT;AAAsBJ,QAAAA,UAAtB;AAAkCM,QAAAA;AAAlC,OAA7B,EAAiF8D,IAAjF,CACH9B,QAAD,IAA6B;AAC3B,cAAM+B,GAAG,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CACV,IAAIC,IAAJ,CAAS,CAACnC,QAAQ,CAACI,IAAV,CAAT,EAA0B;AAACgC,UAAAA,IAAI,EAAE;AAAP,SAA1B,CADU,CAAZ;AAGA,cAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,QAAAA,IAAI,CAACG,IAAL,GAAYT,GAAZ;AACAM,QAAAA,IAAI,CAACI,YAAL,CAAkB,UAAlB,EAA8B,iBAA9B;AACAH,QAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,IAA1B;AACAA,QAAAA,IAAI,CAACO,KAAL;AACD,OAVG,CAAN;AAYD;AACF,GA7BD;;AA+BA,QAAMG,WAAW,GAAG,YAAY;AAC9BzD,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACApB,IAAAA,eAAe,CAAC,CAAC,CAAF,CAAf;AACAM,IAAAA,oBAAoB,CAAC,CAAC,CAAF,CAApB;AACAgB,IAAAA,YAAY,CAAC,EAAD,CAAZ;AACAE,IAAAA,UAAU,CAAC,EAAD,CAAV;AACA3B,IAAAA,UAAU,CAAC,KAAD,CAAV;AACA6B,IAAAA,iBAAiB,CAAC,CAAC,CAAF,CAAjB;AACAhB,IAAAA,OAAO,CAAC,CAAD,CAAP;AACAE,IAAAA,WAAW,CAAC,EAAD,CAAX;AACA,UAAMkB,QAAQ,GAAG,MAAMpD,UAAU,CAACqD,iCAAX,CAA6C;AAClEtB,MAAAA,IAAI,EAAE,CAD4D;AAElEE,MAAAA,QAAQ,EAAE,EAFwD;AAGlEc,MAAAA,cAAc,EAAE,CAAC,CAHiD;AAIlEO,MAAAA,OAAO,EAAE,CAAC,CAJwD;AAKlEpC,MAAAA,WAAW,EAAE,CAAC;AALoD,KAA7C,CAAvB;AAOAQ,IAAAA,cAAc,CAAC0B,QAAQ,CAACI,IAAT,CAAcG,WAAf,CAAd;AACArB,IAAAA,yBAAyB,CAACc,QAAQ,CAACI,IAAT,CAAcC,UAAf,CAAzB;AACAf,IAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,GApBD;;AAsBA,QAAM0D,0BAA0B,GAAG,YAAY;AAC7C,UAAMpG,UAAU,CAACqG,8BAAX,CAA0C;AAC9CtE,MAAAA,IAAI,EAAE,CADwC;AAE9CE,MAAAA,QAAQ,EAAE,CAAC,CAFmC;AAG9CqE,MAAAA,OAAO,EAAE,CAAC,CAHoC;AAI9CC,MAAAA,WAAW,EAAE,CAAC,CAJgC;AAK9CxD,MAAAA,cAAc,EAAEA,cAAc,KAAK,CAAnB,GAAuB,CAAvB,GAA2BA,cALG;AAM9CO,MAAAA,OAAO,EAAEjC,YANqC;AAO9CH,MAAAA,WAAW,EAAES;AAPiC,KAA1C,EAQHuD,IARG,CAQG9B,QAAD,IAA6B;AACnC,YAAM+B,GAAG,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2B,IAAIC,IAAJ,CAAS,CAACnC,QAAQ,CAACI,IAAV,CAAT,EAA0B;AAACgC,QAAAA,IAAI,EAAE;AAAP,OAA1B,CAA3B,CAAZ;AACA,YAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,MAAAA,IAAI,CAACG,IAAL,GAAYT,GAAZ;AACAM,MAAAA,IAAI,CAACI,YAAL,CAAkB,UAAlB,EAA8B,oBAA9B;AACAH,MAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,IAA1B;AACAA,MAAAA,IAAI,CAACO,KAAL;AACD,KAfK,CAAN;AAgBD,GAjBD,CA7M8B,CAgO9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,QAAMQ,0BAA0B,GAAG,YAAY;AAC7C,UAAMpD,QAAQ,GAAG,MAAMpD,UAAU,CAACqD,iCAAX,CAA6C;AAClEtB,MAAAA,IAAI,EAAE,CAD4D;AAElEE,MAAAA,QAAQ,EAAEI,sBAFwD;AAGlEU,MAAAA,cAAc,EAAEA,cAAc,KAAK,CAAnB,GAAuB,CAAvB,GAA2BA,cAHuB;AAIlE,UAAI1B,YAAY,IAAI;AAACiC,QAAAA,OAAO,EAAEjC;AAAV,OAApB,CAJkE;AAKlE,UAAIsB,SAAS,IAAI;AAACA,QAAAA,SAAS,EAAE/C,MAAM,CAAC+C,SAAD,CAAN,CAAkBY,MAAlB;AAAZ,OAAjB,CALkE;AAMlE,UAAIV,OAAO,IAAI;AAACA,QAAAA,OAAO,EAAEjD,MAAM,CAACiD,OAAD,CAAN,CAAgBU,MAAhB;AAAV,OAAf,CANkE;AAOlE,UAAI5B,iBAAiB,IAAI;AAACT,QAAAA,WAAW,EAAES;AAAd,OAAzB;AAPkE,KAA7C,CAAvB;;AAUA,QAAIyB,QAAQ,CAACI,IAAT,CAAcG,WAAlB,EAA+B;AAC7B,YAAMH,IAAgB,GAAG,CACvB,CACE,OADF,EAEE,gBAFF,EAGE,WAHF,EAIE,WAJF,EAKE,QALF,EAME,QANF,EAOE,UAPF,EAQE,cARF,CADuB,CAAzB;AAYA,UAAIiD,YAAY,GAAG,CAAnB;AACA,UAAIC,gBAAgB,GAAG,CAAvB;AACA,UAAIC,gBAAgB,GAAG,CAAvB;AAEAvD,MAAAA,QAAQ,CAACI,IAAT,CAAcG,WAAd,CAA0BiD,OAA1B,CAAmC/C,IAAD,IAA+C;AAC/E4C,QAAAA,YAAY,IAAK5C,IAAI,CAACgD,aAAL,GAAqBhD,IAAI,CAACiD,eAA3B,GAA8C,GAA9D,CAD+E,CAE/E;AACA;AACA;AACA;;AACAJ,QAAAA,gBAAgB,IAAI7C,IAAI,CAACkD,QAAL,KAAkB,CAAlB,GAAsBlD,IAAI,CAACgD,aAA3B,GAA2C,CAA/D;AACAF,QAAAA,gBAAgB,IAAI9C,IAAI,CAACkD,QAAL,KAAkB,CAAlB,GAAsBlD,IAAI,CAACgD,aAA3B,GAA2C,CAA/D;AAEArD,QAAAA,IAAI,CAACW,IAAL,CAAU,CACRN,IAAI,CAACC,UADG,EAERD,IAAI,CAAClD,aAFG,EAGRkD,IAAI,CAACmD,QAHG,EAIRnD,IAAI,CAACoD,iBAJG,EAKP,GAAEpD,IAAI,CAACgD,aAAc,IAAGhD,IAAI,CAACkD,QAAL,KAAkB,CAAlB,GAAsB,KAAtB,GAA8B,KAAM,EALrD,EAMRlD,IAAI,CAACqD,YAAL,CAAkBC,QAAlB,EANQ,EAORtD,IAAI,CAACiD,eAAL,CAAqBK,QAArB,EAPQ,EAQP,GAAE,CAAEtD,IAAI,CAACgD,aAAL,GAAqBhD,IAAI,CAACiD,eAA3B,GAA8C,GAA/C,EAAoDK,QAApD,EAA+D,IAChEtD,IAAI,CAACkD,QAAL,KAAkB,CAAlB,GAAsB,KAAtB,GAA8B,KAC/B,EAVO,CAAV;AAYD,OArBD;AAuBAvD,MAAAA,IAAI,CAACW,IAAL,CAAU,CAAC,GAAD,CAAV;AACAX,MAAAA,IAAI,CAACW,IAAL,CAAU,CACR,gBADQ,EAEP,GAAEuC,gBAAgB,CAACS,QAAjB,EAA4B,MAFvB,EAGP,GAAER,gBAAgB,CAACQ,QAAjB,EAA4B,MAHvB,CAAV;AAKA3D,MAAAA,IAAI,CAACW,IAAL,CAAU,CAAC,eAAD,EAAkBsC,YAAY,CAACU,QAAb,EAAlB,CAAV,EA9C6B,CA+C7B;AACA;AACA;AACA;AACA;;AAEA,YAAMC,UAAU,GAAI,+BAA8B5D,IAAI,CAACI,GAAL,CAAUyD,CAAD,IAAOA,CAAC,CAACC,IAAF,CAAO,GAAP,CAAhB,EAA6BA,IAA7B,CAAkC,IAAlC,CAAwC,EAA1F;AACA,YAAMC,UAAU,GAAGC,SAAS,CAACJ,UAAD,CAA5B;AACA,YAAM3B,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,MAAAA,IAAI,CAACI,YAAL,CAAkB,MAAlB,EAA0B0B,UAA1B;AACA9B,MAAAA,IAAI,CAACI,YAAL,CAAkB,UAAlB,EAA8B,aAA9B;AACAH,MAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,IAA1B;AACAA,MAAAA,IAAI,CAACO,KAAL;AACD;AACF,GAxED;;AA0EA,MAAI,CAACvF,eAAL,EAAsB;AACpB,wBACE,QAAC,GAAD;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA,8BACE,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,uBAAf;AAAA,gCACE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,iCACE,QAAC,WAAD;AACE,YAAA,WAAW,EAAEgE,gBADf;AAEE,YAAA,cAAc,EAAE9B,SAFlB;AAGE,YAAA,YAAY,EAAEE,OAHhB;AAIE,YAAA,QAAQ,EAAE,KAJZ;AAKE,YAAA,MAAM,EAAE,KALV;AAME,YAAA,SAAS,EAAE;AANb;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAWE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,iCACE,QAAC,gBAAD;AACE,YAAA,IAAI,EAAEtB,cADR;AAEE,YAAA,EAAE,EAAEF,YAFN;AAGE,YAAA,SAAS,EAAEoB,SAHb;AAIE,YAAA,KAAK,EAAEnB,eAJT;AAKE,YAAA,KAAK,EAAC;AALR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAXF,eAoBE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,iCACE,QAAC,gBAAD;AACE,YAAA,IAAI,EAAEO,WADR;AAEE,YAAA,EAAE,EAAEF,iBAFN;AAGE,YAAA,SAAS,EAAEc,SAHb;AAIE,YAAA,KAAK,EAAEb,oBAJT;AAKE,YAAA,KAAK,EAAC;AALR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBApBF,eA6BE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,iCACE,QAAC,gBAAD;AACE,YAAA,IAAI,EAAEqB,oBADR;AAEE,YAAA,EAAE,EAAEF,cAFN;AAGE,YAAA,SAAS,EAAEN,SAHb;AAIE,YAAA,KAAK,EAAEO,iBAJT;AAKE,YAAA,KAAK,EAAC;AALR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA7BF,eAsCE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,aAAf;AAAA,iCACE,QAAC,sBAAD;AAAwB,YAAA,WAAW,EAAEmD,WAArC;AAAkD,YAAA,KAAK,EAAC,OAAxD;AAAgE,YAAA,KAAK,EAAC;AAAtE;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAtCF,eAyCE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,oBACG,CAAC5D,cAAD,gBACC,QAAC,UAAD;AAAY,YAAA,WAAW,EAAEsC,WAAzB;AAAsC,YAAA,KAAK,EAAC,OAA5C;AAAoD,YAAA,KAAK,EAAC;AAA1D;AAAA;AAAA;AAAA;AAAA,kBADD,gBAGC,QAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAJJ;AAAA;AAAA;AAAA;AAAA,gBAzCF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAkDE,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,gCACE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,gDAAf;AAAA,kCACE,QAAC,GAAD;AAAA,mCACE,QAAC,sBAAD;AACE,cAAA,WAAW,EAAEuB,0BADf;AAEE,cAAA,KAAK,EAAC;AAFR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,eAOE,QAAC,GAAD;AAAK,YAAA,SAAS,EAAC,OAAf;AAAA,mCACE,QAAC,sBAAD;AACE,cAAA,WAAW,EAAEI,0BADf;AAEE,cAAA,KAAK,EAAC;AAFR;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAPF,eAaE,QAAC,GAAD;AAAK,YAAA,SAAS,EAAC,OAAf;AAAA,mCACE,QAAC,UAAD;AAAY,cAAA,WAAW,EAAE5B,qBAAzB;AAAgD,cAAA,KAAK,EAAC;AAAtD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAkBE,QAAC,GAAD;AAAK,UAAA,SAAS,EAAC,OAAf;AAAA,oBACG,CAACnC,SAAD,IAAchB,WAAW,CAACgG,MAA1B,gBACC,QAAC,GAAD;AAAA,oCACE,QAAC,aAAD;AAAe,cAAA,KAAK,EAAC,oBAArB;AAA0C,cAAA,IAAI,EAAEhG;AAAhD;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,mBAAD;AACE,cAAA,SAAS,EAAEY,sBADb;AAEE,cAAA,OAAO,EAAEL,OAFX;AAGE,cAAA,IAAI,EAAED,IAHR;AAIE,cAAA,eAAe,EAAEI,eAJnB;AAKE,cAAA,QAAQ,EAAEF,QALZ;AAME,cAAA,WAAW,EAAEC;AANf;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,gBAaC;AAAK,YAAA,SAAS,EAAC,uBAAf;AAAA,sBACGO,SAAS,gBAAG,QAAC,gBAAD;AAAA;AAAA;AAAA;AAAA,oBAAH,GAA0B;AADtC;AAAA;AAAA;AAAA;AAAA;AAdJ;AAAA;AAAA;AAAA;AAAA,gBAlBF;AAAA;AAAA;AAAA;AAAA;AAAA,cAlDF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AA2FD;;AACD,sBACE;AAAK,IAAA,SAAS,EAAC,iCAAf;AAAA,2BACE,QAAC,mBAAD;AACE,MAAA,uBAAuB,EAAEsC,uBAD3B;AAEE,MAAA,sBAAsB,EAAED;AAF1B;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AAQD,CA1ZD;;GAAMvE,iB;;KAAAA,iB;AA4ZN,eAAeA,iBAAf","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {Box, CircularProgress} from '@mui/material'\nimport moment from 'moment'\nimport {AxiosResponse} from 'axios'\nimport WrapperCertificates from '../../layouts/certificates/wrapperCertificates'\nimport EnhancedTable from '../../layouts/table/table'\nimport UsersApi from '../../api/users'\nimport {IEnhancedPerformanceReportTableRows} from '../../shared/types/table/table'\nimport ReportsApi from '../../api/reports'\nimport {UseCertificateContext} from '../../context/certificateContext/certificateContext'\nimport {ICertificateProps} from '../../context/certificateContext/certificateContext.props'\nimport PaginationContainer from '../../layouts/pagination/pagination'\nimport SelectWithSearch from '../../layouts/select/selectWithSearch'\nimport AssignDates from '../../layouts/assignDates/assignDates'\nimport ButtonBlue from '../../layouts/buttons/buttonBlue'\nimport ButtonTranparentBorder from '../../layouts/buttons/buttonTransparentBorder'\n\nconst PerformanceReport = () => {\n  const {\n    setShowCertificate,\n    showCertificate,\n    setEvaluateeName,\n    evaluateeName,\n    setTotalScore,\n    setCreateDate,\n    totalScore,\n    setMenual,\n    menual,\n    createDate,\n    evaluateeId,\n    setNoScore,\n    // noScore,\n    certificateType,\n  } = UseCertificateContext() as ICertificateProps\n\n  const [eventTitleId, setEventTitleId] = useState<number>(-1)\n  const [eventTitleData, setEventTitleData] = useState<{name: string; id: number}[]>([])\n  const [rowsOfTable, setRowsOfTable] = useState<IEnhancedPerformanceReportTableRows[]>([])\n  const [searchEvaluateeId, setSearchEvaluateeId] = useState<number>(-1)\n  const [nameOfUsers, setNameOfUsers] = useState<{name: string; id: number}[]>([])\n  const [page, setPage] = useState<number>(1)\n  const [pageSize, setPageSize] = useState<number>(10)\n  const [countPagination, setCountPagination] = useState<number>(0)\n  const [totalCountOfPagination, setTotalCountOfPagination] = useState<number | undefined>()\n  const [isLoadingApply, setIsLoadingApply] = useState<boolean>(false)\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n  const [startDate, setStartDate] = useState<string>('')\n  const [endDate, setEndDate] = useState<string>('')\n  const [evaluationType, setEvaluationType] = useState<number>(-1)\n  const [evaluationTypeValues] = useState<{name: string; id: number}[]>([\n    {\n      id: 1,\n      name: 'With score',\n    },\n    {\n      id: 2,\n      name: 'Without score',\n    },\n  ])\n\n  useEffect(() => {\n    ;(async () => {\n      setIsLoading(true)\n\n      const response = await ReportsApi.evaluationAbsolutePointReportList({\n        page,\n        pageSize,\n        eventId: eventTitleId,\n        evaluateeId: searchEvaluateeId,\n        evaluationType: evaluationType === 2 ? 0 : evaluationType,\n        ...(startDate && {startDate: moment(startDate).format()}),\n        ...(endDate && {endDate: moment(endDate).format()}),\n      })\n      setTotalCountOfPagination(response.data.totalCount)\n\n      const updateEventsTitleData = [\n        ...response.data.reportItems.map((item: {eventTitle: string; eventId: number}) => ({\n          name: item.eventTitle,\n          id: item.eventId,\n        })),\n      ]\n\n      setEventTitleData(\n        updateEventsTitleData.filter((element: {id: number}) => {\n          const isDuplicate = updateEventsTitleData.includes(element.id)\n          if (!isDuplicate) {\n            updateEventsTitleData.push(element.id)\n            return true\n          }\n          return false\n        }),\n      )\n\n      setRowsOfTable(response.data.reportItems)\n      setIsLoading(false)\n    })()\n  }, [pageSize, page])\n\n  useEffect(() => {\n    if (totalCountOfPagination) {\n      if (pageSize >= totalCountOfPagination) {\n        setCountPagination(1)\n      } else {\n        setCountPagination(Math.ceil(totalCountOfPagination / pageSize))\n      }\n    }\n  }, [pageSize, page, totalCountOfPagination])\n\n  useEffect(() => {\n    ;(async () => {\n      const resultUsers = await UsersApi.usersList()\n      setNameOfUsers([\n        ...resultUsers.data.map((item: {firstName: string; id: number}) => ({\n          name: item.firstName,\n          id: item.id,\n        })),\n      ])\n    })()\n  }, [])\n\n  const handleChangeDate = (start: string, end: string) => {\n    setStartDate(start)\n    setEndDate(end)\n  }\n\n  const handleShowCertificate = () => {\n    setShowCertificate(true)\n    setMenual(true)\n    setEvaluateeName('')\n    setTotalScore('')\n    setCreateDate('')\n  }\n\n  const handleApply = async () => {\n    setIsLoadingApply(true)\n\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: 10,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      ...(eventTitleId && {eventId: eventTitleId}),\n      ...(startDate && {startDate: moment(startDate).format()}),\n      ...(endDate && {endDate: moment(endDate).format()}),\n      ...(searchEvaluateeId && {evaluateeId: searchEvaluateeId}),\n    })\n\n    setPage(1)\n    setPageSize(10)\n    setRowsOfTable(response.data.reportItems)\n    setTotalCountOfPagination(response.data.totalCount)\n    if (evaluationType === 1) {\n      setNoScore(false)\n    } else {\n      setNoScore(true)\n    }\n    setIsLoadingApply(false)\n  }\n\n  const handleOpenCertificates = () => {\n    if (!showCertificate) {\n      setShowCertificate(true)\n    } else {\n      setShowCertificate(false)\n      setEvaluateeName('')\n      setTotalScore('')\n      setCreateDate('')\n    }\n  }\n\n  const handleCreateCertificate = async () => {\n    if (menual) {\n      await ReportsApi.createManualCertificate({\n        userName: evaluateeName,\n        totalScore,\n        createDate,\n        certificateType,\n      }).then((response: AxiosResponse) => {\n        const url = window.URL.createObjectURL(new Blob([response.data], {type: 'application/pdf'}))\n        const link = document.createElement('a')\n        link.href = url\n        link.setAttribute('download', 'Certificate.pdf')\n        document.body.appendChild(link)\n        link.click()\n      })\n    } else {\n      await ReportsApi.createCertificate({userId: evaluateeId, totalScore, certificateType}).then(\n        (response: AxiosResponse) => {\n          const url = window.URL.createObjectURL(\n            new Blob([response.data], {type: 'application/pdf'}),\n          )\n          const link = document.createElement('a')\n          link.href = url\n          link.setAttribute('download', 'Certificate.pdf')\n          document.body.appendChild(link)\n          link.click()\n        },\n      )\n    }\n  }\n\n  const handleClear = async () => {\n    setIsLoading(true)\n    setEventTitleId(-1)\n    setSearchEvaluateeId(-1)\n    setStartDate('')\n    setEndDate('')\n    setNoScore(false)\n    setEvaluationType(-1)\n    setPage(1)\n    setPageSize(10)\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: 10,\n      evaluationType: -1,\n      eventId: -1,\n      evaluateeId: -1,\n    })\n    setRowsOfTable(response.data.reportItems)\n    setTotalCountOfPagination(response.data.totalCount)\n    setIsLoading(false)\n  }\n\n  const handleCreateReportTablePDF = async () => {\n    await ReportsApi.createReportEvaluationAbsolute({\n      page: 1,\n      pageSize: -1,\n      adminId: -1,\n      evaluatorId: -1,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      eventId: eventTitleId,\n      evaluateeId: searchEvaluateeId,\n    }).then((response: AxiosResponse) => {\n      const url = window.URL.createObjectURL(new Blob([response.data], {type: 'application/pdf'}))\n      const link = document.createElement('a')\n      link.href = url\n      link.setAttribute('download', 'PairsReportPdf.pdf')\n      document.body.appendChild(link)\n      link.click()\n    })\n  }\n\n  // const filterRating = (number: number) => {\n  //   if (number <= 3) {\n  //     return rowsOfTable\n  //       .filter((item) => item.sumPoint / item.questionCount <= number)\n  //       .length.toString()\n  //   }\n  //   return rowsOfTable\n  //     .filter((item) => item.sumPoint / item.questionCount >= number)\n  //     .length.toString()\n  // }\n\n  const handleCreateReportTableCVS = async () => {\n    const response = await ReportsApi.evaluationAbsolutePointReportList({\n      page: 1,\n      pageSize: totalCountOfPagination,\n      evaluationType: evaluationType === 2 ? 0 : evaluationType,\n      ...(eventTitleId && {eventId: eventTitleId}),\n      ...(startDate && {startDate: moment(startDate).format()}),\n      ...(endDate && {endDate: moment(endDate).format()}),\n      ...(searchEvaluateeId && {evaluateeId: searchEvaluateeId}),\n    })\n\n    if (response.data.reportItems) {\n      const data: string[][] = [\n        [\n          'Event',\n          'Evaluatee name',\n          'Hire Date',\n          'Job Title',\n          'Salary',\n          'Rating',\n          'Bonus: %',\n          'Bonus Amount',\n        ],\n      ]\n      let totalBonuses = 0\n      let totalSalariesAMD = 0\n      let totalSalariesUSD = 0\n\n      response.data.reportItems.forEach((item: IEnhancedPerformanceReportTableRows) => {\n        totalBonuses += (item.monthlySalary * item.bonusPercentage) / 100\n        // totalSalariesAMD +=\n        //   item.currency === 1 ? (item.monthlySalary * item.bonusPercentage) / 100 : 0\n        // totalSalariesUSD +=\n        //   item.currency !== 1 ? (item.monthlySalary * item.bonusPercentage) / 100 : 0\n        totalSalariesAMD += item.currency === 1 ? item.monthlySalary : 0\n        totalSalariesUSD += item.currency !== 1 ? item.monthlySalary : 0\n\n        data.push([\n          item.eventTitle,\n          item.evaluateeName,\n          item.hireDate,\n          item.evaluateePosition,\n          `${item.monthlySalary} ${item.currency === 1 ? 'AMD' : 'USD'}`,\n          item.averagePoint.toString(),\n          item.bonusPercentage.toString(),\n          `${((item.monthlySalary * item.bonusPercentage) / 100).toString()} ${\n            item.currency === 1 ? 'AMD' : 'USD'\n          }`,\n        ])\n      })\n\n      data.push([' '])\n      data.push([\n        'Total Salaries',\n        `${totalSalariesAMD.toString()} AMD`,\n        `${totalSalariesUSD.toString()} USD`,\n      ])\n      data.push(['Total Bonuses', totalBonuses.toString()])\n      // data.push([' '])\n      // data.push([filterRating(4), 'Exceptional'])\n      // data.push([filterRating(3), 'Very Good'])\n      // data.push([filterRating(2), 'Good'])\n      // data.push([filterRating(1), 'Normal'])\n\n      const csvContent = `data:text/csv;charset=utf-8,${data.map((e) => e.join(',')).join('\\n')}`\n      const encodedUri = encodeURI(csvContent)\n      const link = document.createElement('a')\n      link.setAttribute('href', encodedUri)\n      link.setAttribute('download', 'my_data.csv')\n      document.body.appendChild(link)\n      link.click()\n    }\n  }\n\n  if (!showCertificate) {\n    return (\n      <Box className=\"performance-report\">\n        <Box className=\"d-flex flex-wrap mt-2\">\n          <Box className=\"width-px-320 mt-18 mr-16\">\n            <AssignDates\n              applyHandle={handleChangeDate}\n              startDateProps={startDate}\n              endDateProps={endDate}\n              disabled={false}\n              border={false}\n              fromToday={false}\n            />\n          </Box>\n          <Box className=\"mt-18 mr-16 width-px-218\">\n            <SelectWithSearch\n              data={eventTitleData}\n              id={eventTitleId}\n              isLoading={isLoading}\n              setId={setEventTitleId}\n              label=\"Event Title\"\n            />\n          </Box>\n          <Box className=\"mt-18 mr-16 width-px-218\">\n            <SelectWithSearch\n              data={nameOfUsers}\n              id={searchEvaluateeId}\n              isLoading={isLoading}\n              setId={setSearchEvaluateeId}\n              label=\"Evaluatee\"\n            />\n          </Box>\n          <Box className=\"mt-18 mr-48 width-px-218\">\n            <SelectWithSearch\n              data={evaluationTypeValues}\n              id={evaluationType}\n              isLoading={isLoading}\n              setId={setEvaluationType}\n              label=\"Evaluation Type\"\n            />\n          </Box>\n          <Box className=\"mt-18 mr-16\">\n            <ButtonTranparentBorder handleClick={handleClear} title=\"Clear\" width=\"width150\" />\n          </Box>\n          <Box className=\"mt-18 mr-16 \">\n            {!isLoadingApply ? (\n              <ButtonBlue handleClick={handleApply} title=\"Apply\" width=\"width150\" />\n            ) : (\n              <CircularProgress />\n            )}\n          </Box>\n        </Box>\n        <Box className=\"mt-94\">\n          <Box className=\"mt-26 d-flex justify-end export-button-wrapper\">\n            <Box>\n              <ButtonTranparentBorder\n                handleClick={handleCreateReportTablePDF}\n                title=\"EXPORT AS PDF\"\n              />\n            </Box>\n            <Box className=\"ml-10\">\n              <ButtonTranparentBorder\n                handleClick={handleCreateReportTableCVS}\n                title=\"EXPORT AS CSV\"\n              />\n            </Box>\n            <Box className=\"ml-10\">\n              <ButtonBlue handleClick={handleShowCertificate} title=\"GET CERTIFICATE\" />\n            </Box>\n          </Box>\n          <Box className=\"mt-40\">\n            {!isLoading && rowsOfTable.length ? (\n              <Box>\n                <EnhancedTable table=\"performance-report\" rows={rowsOfTable} />\n                <PaginationContainer\n                  limitData={totalCountOfPagination}\n                  setPage={setPage}\n                  page={page}\n                  countPagination={countPagination}\n                  pageSize={pageSize}\n                  setPageSize={setPageSize}\n                />\n              </Box>\n            ) : (\n              <div className=\"d-flex justify-center\">\n                {isLoading ? <CircularProgress /> : 'There is not data'}\n              </div>\n            )}\n          </Box>\n        </Box>\n      </Box>\n    )\n  }\n  return (\n    <div className=\"saved-submissions-certification\">\n      <WrapperCertificates\n        handleCreateCertificate={handleCreateCertificate}\n        handleOpenCertificates={handleOpenCertificates}\n      />\n    </div>\n  )\n}\n\nexport default PerformanceReport\n"]},"metadata":{},"sourceType":"module"}